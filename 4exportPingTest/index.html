

<h1>HELLO!</h1>

<script src="http://localhost/blockly/blockly_compressed.js"></script>
<script src="http://localhost/blockly/blocks_compressed.js"></script>
<script src="http://localhost/blockly/en.js"></script>
<script src="http://localhost/blockly/php_compressed.js"></script>

<script src="http://localhost/techChal/saveFileTest/pingRequest2"></script>
<script src="http://localhost/techChal/saveFileTest/pingRequest2.js"></script>

<div id="blocklyDiv" style="height: 480px; width: 600px;"></div>

<xml id="toolbox" style="display: none">
  <block type="pingrequest2"></block>
  <block type="controls_if"></block>
  <block type="controls_repeat_ext"></block>
  <block type="logic_compare"></block>
  <block type="math_number"></block>
  <block type="math_arithmetic"></block>
  <block type="text"></block>
  <block type="text_print"></block>
</xml>

<script>
  var workspacePlayground = Blockly.inject('blocklyDiv',
      {toolbox: document.getElementById('toolbox')});

  function execute() {
    var code = Blockly.PHP.workspaceToCode(workspacePlayground);

    try {
      console.log("exporting code:");
      console.log(code);

      var codeArray = code.split("<fileName>\n");
      var fileName = codeArray[0].replace("'","").replace("'","");
      var phpCode = codeArray[1];

      var xhttp = new XMLHttpRequest();
      xhttp.open("POST", "saveFile2.php?fileName="+fileName+".php", true);
      xhttp.send(phpCode);
    } catch (e) {
        alert(e);
    }
    }
</script>

<button type="button" onclick="execute()">"execute that code boiii!"</button>
